@page
@using Microsoft.AspNetCore.Mvc.RazorPages
@model PRN221_Project_Cinema.Pages.Movies.DetailModel
@{
}

<div class="container mt-3">
    <div class="row">
        <div class="col-4">
            <img class="img-fluid mt-1"
                 src=@("https://image.tmdb.org/t/p/w500"+Model.Movie.Image)
                 alt="Avatar" />
        </div>
        <div class="col-8">
            <h1>@Model.Movie.Title</h1>
            <span class="fw-bold">Thể loại:</span>
            <span>@Model.Movie.Genre.Description</span>
            <br />
            <span class="fw-bold">Điểm đánh giá:</span>
            <span>
                @(Model.RateList != null ? Model.RateList.Average(r => r.NumericRating) : "Chưa có điểm đánh giá")
            </span>
            <br />
            <span class="fw-bold">Mô tả:</span>
            <span>
                @Model.Movie.Description
            </span>
            <hr />

            @if (Context.Session.GetString("email"))
            {
                // todo: you have to login first
            }
            
            <form method="post">
                <h2>Chi tiết đánh giá:</h2>
                <label asp-for="@Model.CurrentRate.NumericRating">Điểm đánh giá: </label>
                <input asp-for="@Model.CurrentRate.NumericRating" class="d-inline mx-4" type="number" />
                <br />
                <span asp-validation-for="@Model.CurrentRate.NumericRating" class="text-danger"></span><br />
                <label asp-for="@Model.CurrentRate.Comment">Bình luận:</label>
                <textarea asp-for="@Model.CurrentRate.Comment" style="height: 100px" class="w-100 d-block">
                </textarea>
                <span asp-validation-for="@Model.CurrentRate.Comment" class="text-danger"></span>
              

                <br />
                <input type="submit" class="btn btn-primary mt-2 mb-4" value="Đánh giá" />
            </form>
            <hr />

            <h2>Bình luận:</h2>
            @if (Model.RateList == null)
            {
                <span>Chưa có bình luận cho phim này</span>
            }
            else
            {
                foreach (var item in Model.RateList)
                {
                    <span class="fw-bold">@item.Person.Fullname :</span>
                    <span>
                        @item.Comment
                    </span>
                    <br />
                }
            }
        </div>
    </div>
</div>


